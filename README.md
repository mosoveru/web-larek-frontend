# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
---  
## Архитектура  
![](WEB-larek.png)  
## Базовый код  
### 1. Класс ``Api``  
Базовый класс для работы с API проекта WEB-ларёк. Конструктор класса принимает такие аргументы:  
1. Базовый URL ``baseUrl: string``.  
2. Объект настроек типа ``RequestInit``.  
Класс имеет такие методы:  
+ ``get`` и ``post`` для работы с получением и отправкой запроса соответственно. 
+ ``handleResponse`` для обработки пришедшего ответа и обработки ошибок запроса.  
### 2. Класс ``EventEmitter``  
Реализует паттерн «Наблюдатель» и позволяет подписываться на события и уведомлять подписчиков о наступлении события.  
Класс имеет методы ``on`` , ``off`` , ``emit`` — для подписки на событие, отписки от события и уведомления подписчиков о наступлении события соответственно.  
Дополнительно реализованы методы ``onAll`` и ``offAll`` — для подписки на все события и сброса всех подписчиков.  
Интересным дополнением является метод ``trigger`` , генерирующий заданное событие с заданными аргументами. Это позволяет передавать его в качестве обработчика события в другие классы. Эти классы будут генерировать события, не будучи при этом напрямую зависимыми от класса ``EventEmitter`` .  
## Компоненты модели данных (бизнес-логика)  
### 1. Класс ``Product``  
Класс ``Product`` хранит данные товара карточки. Реализует интерфейс ``IProduct``, который содержит в себе основные поля с информацией, приходящие с Api.
Класс содержит основные поля карточки товара, такие как:  
+ ``category: string`` - категория товара
+ ``title: string`` - наименование товара
+ ``image: string`` - ресурс с изображением карточки товара
+ ``cost: number`` - стоимость товара
+ ``description: string`` - описание товара
+ ``id: string`` - уникальный идентификатор товара  
Класс имеет метод ``returnProperties(): IProduct``, который возвращает объект с данными, реализующий интерфейс ``IProduct``.
### 2. Класс ``ProductList``  
Класс ``ProductList`` хранит объекты типа ``IProduct`` в коллекции ``Map``. Класс реализует интерфейс ``IList``, который описывает базовое поле и методы для работы с коллекцией.  
Поле класса ``List: Map<string, IProduct>`` хранит в себе коллекцию ``Map``, где ключом является поле ``id`` класса ``Product``, а само значение - экземпляр класса ``Product``.
Методы класса:  
+ ``returnList(): IProduct[]`` - возвращает массив объектов типа ``IProduct``.
+ ``fillList(product: IProduct | IProduct[]): void`` - метод для заполнения коллекции ``Map``. На вход принимает массив объектов или сам объект класса ``Product``.  
### 3. Класс ``Cart``  
Класс ``Cart`` по аналогии с классом ``ProductList`` хранит объекты типа ``IProduct``, но только те, которые пользователь добавил в корзину с товарами. Класс реализует интерфейс ``IList``, но имеет дополнительные методы для работы с корзиной:  
+ ``removeFromCart(productId: string): void`` - метод, который удаляет конкретный товар из корзины.
+ ``resetCart(): void`` - метод, который полностью очищает корзину с товарами.  
### 4. Класс ``Person``  
Класс ``Person`` хранит в себе данные пользователя. Реализует интерфейсы ``IPerson``, который описывает все поля с данными пользователя.  
Поля класса:  
+ ``email: string`` - E-Mail пользователя.
+ ``telephone: string`` - телефон пользователя.
+ ``billingMethod: string`` - способ оплаты
+ ``address: string`` - адрес доставки пользователя.  
Класс содержит сеттеры для установки значения полей:  
+ ``saveAddress(address: string): void`` - для установки адреса
+ ``chooseBillingMethod(billingMethod: string): void`` - для установки способа оплаты
+ ``saveTelephone(telephone: string): void`` - для установки номера телефона
+ ``saveEmail(email: string): void`` - для установки электронного адреса  

## Компоненты представления  
### Класс ``CommonUI<T>``  
Класс выводит на экран карточки товаров и модальные окна, в зависимости от события в интерфейсе.  
Конструктор класса принимает на вход контейнер, а также шаблон, который используется для построения отображения данных и их вывода в контейнер. Дженерик ``T`` показывает тип данных, которые принимает метод для отображения.
Поля класса:  
+ ``container: HTMLElement`` - контейнер для вывода данных
+ ``template: HTMLElement`` - шаблон для заполнения данными  
Метод класса ``render(data: T): void`` принимает на вход объект с данными, с помощью которых заполняется шаблон для вывода в контейнер.  
## Ключевые типы данных  
```
enum Events {
  LIST_READY = 'user:list-ready', //Список с товарами готов
  ADD_CART = 'user:add-to-cart', //Пользователь добавил товар в корзину
  DELETE_CART = 'user:clear-cart', //Пользователь полностью очистил корзину
  DELETE_ITEM = 'user:clear-cart-item', //Пользователь удалил предмет из корзины
  CONTACTS_DATA = 'user:contacts', //Сохранены контактные данные пользователя
  ADDRESS_DATA = 'user:address', //Сохранен адрес пользователя
  USER_DATA_READY = 'user:data-ready', //Объект с данными пользователя готов
  FILL_PAGE = 'ui:fill', //Отображение карточек товара на странице
  SHOW_PREVIEW = 'ui:preview', //Открытие меню предпросмотра карточки товара
  CART_PAGE = 'ui:show-cart', //Открытие модального окна с корзиной товаров
  CONTACTS_PAGE = 'ui:show-contacts-page', //Открытие модального окна для оформления заказа
  ADDRESS_PAGE = 'ui:show-address-page', //Открытие модального окна для оформления заказа
  SUCCESS_PAGE = 'ui:show-success-page' //Модальное окно о завершении оформления заказа
};
```

